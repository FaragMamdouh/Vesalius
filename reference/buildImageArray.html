<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>buildImageArray creating an Image array from coloured coordinates — buildImageArray • vesalius</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="buildImageArray creating an Image array from coloured coordinates — buildImageArray"><meta property="og:description" content="buildImageArray creating an Image array from coloured coordinates"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vesalius</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/vesalius.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Vesalius_Analysis/Vesalius_analysis.html">Vesalius Manuscript Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/patrickCNMartin/Vesalius/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>buildImageArray creating an Image array from coloured coordinates</h1>
    <small class="dont-index">Source: <a href="https://github.com/patrickCNMartin/Vesalius/blob/main/R/PCA_to_RGB.R" class="external-link"><code>R/PCA_to_RGB.R</code></a></small>
    <div class="hidden name"><code>buildImageArray.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>buildImageArray creating an Image array from coloured coordinates</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">buildImageArray</span><span class="op">(</span>
  <span class="va">coordinates</span>,
  sliceID <span class="op">=</span> <span class="fl">1</span>,
  invert <span class="op">=</span> <span class="cn">FALSE</span>,
  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,
  resolution <span class="op">=</span> <span class="fl">100</span>,
  filterThreshold <span class="op">=</span> <span class="fl">0.999</span>,
  interpolation_type <span class="op">=</span> <span class="fl">1</span>,
  cores <span class="op">=</span> <span class="fl">1</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>coordinates</dt>
<dd><p>a Vesalius data.frame with "barcodes","x","y","cc",
"value","slice". Output from <code>rgbPCA</code>.</p></dd>
<dt>sliceID</dt>
<dd><p>integer - PC slice used in image building. Only one value!</p></dd>
<dt>invert</dt>
<dd><p>logical describing if colour pattern should be inverted
(i.e 1-R,1-G,1-B)</p></dd>
<dt>na.rm</dt>
<dd><p>logical indicating if NA should be removed from bead list.</p></dd>
<dt>resolution</dt>
<dd><p>numeric (range 0 - 100) describing a percentage of original
image size. Used to reduce image size.</p></dd>
<dt>filterThreshold</dt>
<dd><p>numeric (range 0 -1) describing the quantile threshold
at which barcodes and tiles should be retained (seed details)</p></dd>
<dt>interpolation_type</dt>
<dd><p>Method of interpolation during image resizing:</p><dl><dt>-1</dt>
<dd><p>no interpolation: raw memory resizing.</p></dd>

   <dt>0</dt>
<dd><p>no interpolation: additional space is filled according to
            boundary_conditions.</p></dd>

   <dt>1</dt>
<dd><p>Nearest-neighbor interpolation</p></dd>

   <dt>2</dt>
<dd><p>moving average interpolation</p></dd>

   <dt>3</dt>
<dd><p>linear interpolation</p></dd>

   <dt>4</dt>
<dd><p>grid interpolation</p></dd>

   <dt>5</dt>
<dd><p>cubic interpolation</p></dd>

   <dt>6</dt>
<dd><p>lanczos interpolation</p></dd>


</dl></dd>
<dt>cores</dt>
<dd><p>integer describing number of cores used (Default = 1)</p></dd>
<dt>verbose</dt>
<dd><p>logical - progress message output.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a Vesalius data.frame with "barcodes","x","y","cc",
"value",and "tile".</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Vesalius converts PCA loading values into an RGB colour code
associated with a coordinates on a Spatial Transcriptomic Assay. The
<code>buildImageArray</code> converts coloured coordinates into an actual image
via the use of Voronoi diagrams and Tile rasterisation.</p>
<p>Each barcodes coordinate is used as the center point of a voronoi tile and
an artificial "box" is created surrounding barcode coordinates. This
creates superfluous tiles that can be detrimental to further analysis.
To remove excessive tiles, Vesalius takes a two step process. First, Vesalius
removes any barcode that is too far away from other barcodes (likely stray
barcodes). Second, Vesalius filters out tiles that are tied to the outer box
and that exceed a certain area threshold. These triangles are nearly always
related to boundary tiles. Both of these filtering steps are controlled via
the <code>filterThreshold</code> argument.</p>
<p>A filterThreshold of 0.99 means that 99 % or barcodes and tile triangles
will be retained.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">NormalizeData</span><span class="op">(</span><span class="va">vesalius</span><span class="op">)</span></span>
<span class="r-in"><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">FindVariableFeatures</span><span class="op">(</span><span class="va">image</span>, nfeatures <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span class="r-in"><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">ScaleData</span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># converting to rgb</span></span>
<span class="r-in"><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgbPCA.html">rgbPCA</a></span><span class="op">(</span><span class="va">image</span>,slices <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Slice ID = PCA slice</span></span>
<span class="r-in"><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">buildImageArray</span><span class="op">(</span><span class="va">image</span>, sliceID <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># If rgbUMAP was run - no need to specifiy slice</span></span>
<span class="r-in"><span class="va">image</span> <span class="op">&lt;-</span> <span class="fu">buildImageArray</span><span class="op">(</span><span class="va">image</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick C.N. Martin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

